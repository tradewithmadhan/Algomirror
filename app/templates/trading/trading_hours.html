{% extends "layout.html" %}

{% block title %}Trading Hours - AlgoMirror{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold">Trading Hours Management</h1>
        <button onclick="addNewTemplate()" class="btn btn-primary">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            Add Template
        </button>
    </div>

    <!-- Templates List -->
    <div class="grid gap-6">
        {% for template in templates %}
        <div class="card bg-base-200 shadow-lg">
            <div class="card-body">
                <div class="flex justify-between items-start">
                    <div>
                        <h2 class="card-title">{{ template.name }}</h2>
                        <p class="text-base-content/70">{{ template.description or 'No description' }}</p>
                        <div class="mt-2">
                            <span class="badge {{ 'badge-success' if template.is_active else 'badge-ghost' }}">
                                {{ 'Active' if template.is_active else 'Inactive' }}
                            </span>
                            <span class="badge badge-outline ml-2">{{ template.market }}</span>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="editTemplate({{ template.id }})" class="btn btn-sm btn-ghost">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                        </button>
                        <button onclick="deleteTemplate({{ template.id }})" class="btn btn-sm btn-ghost text-error">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Sessions -->
                <div class="mt-6">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="text-lg font-semibold">Trading Sessions</h3>
                        <button onclick="editSessions({{ template.id }}, '{{ template.name }}')" class="btn btn-sm btn-primary">
                            Edit Sessions
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Day</th>
                                    <th>Session</th>
                                    <th>Start Time</th>
                                    <th>End Time</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for session in template.sessions.filter_by(is_active=True) %}
                                <tr id="session-{{ session.id }}">
                                    <td>{{ ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'][session.day_of_week] }}</td>
                                    <td>{{ session.session_name }}</td>
                                    <td class="start-time">{{ session.start_time.strftime('%H:%M') }}</td>
                                    <td class="end-time">{{ session.end_time.strftime('%H:%M') }}</td>
                                    <td>
                                        <span class="badge badge-sm badge-success">Active</span>
                                    </td>
                                    <td>
                                        <button onclick="quickEditSession({{ session.id }})" class="btn btn-xs btn-ghost">
                                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                                      d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                            </svg>
                                        </button>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        {% else %}
        <div class="alert alert-info">
            <svg class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <span>No trading hours templates configured. Click "Add Template" to create one.</span>
        </div>
        {% endfor %}
    </div>

    <!-- Special Trading Sessions Section -->
    <div class="mt-8">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-2xl font-bold">Special Trading Sessions</h2>
            <button onclick="addSpecialSession()" class="btn btn-sm btn-primary">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                Add Special Session
            </button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for session in special_sessions %}
            <div class="card bg-base-200">
                <div class="card-body p-4">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="font-semibold">{{ session.session_name }}</h3>
                            <p class="text-sm text-base-content/70">{{ session.session_date.strftime('%B %d, %Y') }}</p>
                            <p class="text-sm">{{ session.start_time.strftime('%I:%M %p') }} - {{ session.end_time.strftime('%I:%M %p') }}</p>
                            {% if session.description %}
                            <p class="text-xs text-base-content/60 mt-1">{{ session.description }}</p>
                            {% endif %}
                            <div class="flex gap-2 mt-2">
                                <span class="badge badge-sm">{{ session.market }}</span>
                                {% if session.is_active %}
                                <span class="badge badge-sm badge-success">Active</span>
                                {% else %}
                                <span class="badge badge-sm badge-ghost">Inactive</span>
                                {% endif %}
                            </div>
                        </div>
                        <button onclick="deleteSpecialSession({{ session.id }}, '{{ session.session_name }}')" 
                                class="btn btn-ghost btn-xs text-error">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                      d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="col-span-full alert">
                <span>No special trading sessions configured.</span>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Market Holidays Section -->
    <div class="mt-8">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-2xl font-bold">Market Holidays</h2>
            <button onclick="addHoliday()" class="btn btn-sm btn-primary">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                Add Holiday
            </button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for holiday in holidays %}
            <div class="card bg-base-200">
                <div class="card-body p-4">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="font-semibold">{{ holiday.holiday_name }}</h3>
                            <p class="text-sm text-base-content/70">{{ holiday.holiday_date.strftime('%B %d, %Y') }}</p>
                            <div class="flex gap-2 mt-2">
                                <span class="badge badge-sm">{{ holiday.market }}</span>
                                {% if holiday.is_special_session %}
                                <span class="badge badge-sm badge-warning">Special Session</span>
                                {% endif %}
                            </div>
                        </div>
                        <button onclick="deleteHoliday({{ holiday.id }}, '{{ holiday.holiday_name }}')" 
                                class="btn btn-ghost btn-xs text-error">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                      d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="col-span-full alert">
                <span>No holidays configured for the current year.</span>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Service Status -->
    <div class="mt-8">
        <h2 class="text-2xl font-bold mb-4">Background Service Status</h2>
        <div class="stats shadow w-full">
            <div class="stat">
                <div class="stat-title">Service Status</div>
                <div class="stat-value text-sm">
                    <span class="badge {{ 'badge-success' if service_status.is_running else 'badge-error' }} badge-lg">
                        {{ 'Running' if service_status.is_running else 'Stopped' }}
                    </span>
                </div>
            </div>
            <div class="stat">
                <div class="stat-title">Primary Account</div>
                <div class="stat-value text-sm">{{ service_status.primary_account or 'Not Connected' }}</div>
                <div class="stat-desc">{{ service_status.backup_accounts }} backup accounts</div>
            </div>
            <div class="stat">
                <div class="stat-title">Active Option Chains</div>
                <div class="stat-value text-sm">
                    {% if service_status.active_option_chains %}
                        {{ service_status.active_option_chains|join(', ') }}
                    {% else %}
                        None
                    {% endif %}
                </div>
                <div class="stat-desc">
                    {{ 'Trading Hours' if service_status.is_trading_hours else 'After Hours' }}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Edit Session Modal -->
<dialog id="editSessionModal" class="modal">
    <div class="modal-box max-w-2xl">
        <h3 class="font-bold text-lg mb-4">Edit Trading Sessions</h3>
        <form method="POST" action="{{ url_for('trading.update_sessions') }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="hidden" name="template_id" id="edit-template-id">
            
            <div class="space-y-4">
                <!-- Monday -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">Monday</span>
                    </label>
                    <div class="flex gap-4 items-center">
                        <input type="time" name="monday_start" class="input input-bordered input-sm" value="09:15">
                        <span>to</span>
                        <input type="time" name="monday_end" class="input input-bordered input-sm" value="15:30">
                        <label class="cursor-pointer label">
                            <input type="checkbox" name="monday_active" class="checkbox checkbox-sm" checked>
                            <span class="label-text ml-2">Active</span>
                        </label>
                    </div>
                </div>
                
                <!-- Tuesday -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">Tuesday</span>
                    </label>
                    <div class="flex gap-4 items-center">
                        <input type="time" name="tuesday_start" class="input input-bordered input-sm" value="09:15">
                        <span>to</span>
                        <input type="time" name="tuesday_end" class="input input-bordered input-sm" value="15:30">
                        <label class="cursor-pointer label">
                            <input type="checkbox" name="tuesday_active" class="checkbox checkbox-sm" checked>
                            <span class="label-text ml-2">Active</span>
                        </label>
                    </div>
                </div>
                
                <!-- Wednesday -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">Wednesday</span>
                    </label>
                    <div class="flex gap-4 items-center">
                        <input type="time" name="wednesday_start" class="input input-bordered input-sm" value="09:15">
                        <span>to</span>
                        <input type="time" name="wednesday_end" class="input input-bordered input-sm" value="15:30">
                        <label class="cursor-pointer label">
                            <input type="checkbox" name="wednesday_active" class="checkbox checkbox-sm" checked>
                            <span class="label-text ml-2">Active</span>
                        </label>
                    </div>
                </div>
                
                <!-- Thursday -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">Thursday</span>
                    </label>
                    <div class="flex gap-4 items-center">
                        <input type="time" name="thursday_start" class="input input-bordered input-sm" value="09:15">
                        <span>to</span>
                        <input type="time" name="thursday_end" class="input input-bordered input-sm" value="15:30">
                        <label class="cursor-pointer label">
                            <input type="checkbox" name="thursday_active" class="checkbox checkbox-sm" checked>
                            <span class="label-text ml-2">Active</span>
                        </label>
                    </div>
                </div>
                
                <!-- Friday -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">Friday</span>
                    </label>
                    <div class="flex gap-4 items-center">
                        <input type="time" name="friday_start" class="input input-bordered input-sm" value="09:15">
                        <span>to</span>
                        <input type="time" name="friday_end" class="input input-bordered input-sm" value="15:30">
                        <label class="cursor-pointer label">
                            <input type="checkbox" name="friday_active" class="checkbox checkbox-sm" checked>
                            <span class="label-text ml-2">Active</span>
                        </label>
                    </div>
                </div>
                
                <!-- Saturday (optional) -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">Saturday</span>
                    </label>
                    <div class="flex gap-4 items-center">
                        <input type="time" name="saturday_start" class="input input-bordered input-sm" value="09:15">
                        <span>to</span>
                        <input type="time" name="saturday_end" class="input input-bordered input-sm" value="15:30">
                        <label class="cursor-pointer label">
                            <input type="checkbox" name="saturday_active" class="checkbox checkbox-sm">
                            <span class="label-text ml-2">Active</span>
                        </label>
                    </div>
                </div>
                
                <!-- Sunday (optional) -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">Sunday</span>
                    </label>
                    <div class="flex gap-4 items-center">
                        <input type="time" name="sunday_start" class="input input-bordered input-sm" value="09:15">
                        <span>to</span>
                        <input type="time" name="sunday_end" class="input input-bordered input-sm" value="15:30">
                        <label class="cursor-pointer label">
                            <input type="checkbox" name="sunday_active" class="checkbox checkbox-sm">
                            <span class="label-text ml-2">Active</span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="modal-action">
                <button type="button" class="btn" onclick="editSessionModal.close()">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

<!-- Quick Edit Session Modal -->
<dialog id="quickEditModal" class="modal">
    <div class="modal-box">
        <h3 class="font-bold text-lg mb-4">Quick Edit Session</h3>
        <form id="quickEditForm">
            <input type="hidden" id="quick-session-id">
            
            <div class="form-control mb-3">
                <label class="label">
                    <span class="label-text">Start Time</span>
                </label>
                <input type="time" id="quick-start-time" class="input input-bordered" required>
            </div>
            
            <div class="form-control mb-3">
                <label class="label">
                    <span class="label-text">End Time</span>
                </label>
                <input type="time" id="quick-end-time" class="input input-bordered" required>
            </div>
            
            <div class="modal-action">
                <button type="button" class="btn" onclick="quickEditModal.close()">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveQuickEdit()">Save</button>
            </div>
        </form>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

<!-- Add Special Session Modal -->
<dialog id="specialSessionModal" class="modal">
    <div class="modal-box">
        <h3 class="font-bold text-lg mb-4">Add Special Trading Session</h3>
        <form method="POST" action="{{ url_for('trading.add_special_session') }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            
            <div class="form-control mb-3">
                <label class="label">
                    <span class="label-text">Session Date</span>
                </label>
                <input type="date" name="session_date" class="input input-bordered" required>
            </div>
            
            <div class="form-control mb-3">
                <label class="label">
                    <span class="label-text">Session Name</span>
                </label>
                <input type="text" name="session_name" class="input input-bordered" 
                       placeholder="e.g., Muhurat Trading, Special Session" required>
            </div>
            
            <div class="form-control mb-3">
                <label class="label">
                    <span class="label-text">Market</span>
                </label>
                <select name="market" class="select select-bordered">
                    <option value="NSE" selected>NSE</option>
                    <option value="BSE">BSE</option>
                    <option value="MCX">MCX</option>
                </select>
            </div>
            
            <div class="grid grid-cols-2 gap-3">
                <div class="form-control">
                    <label class="label">
                        <span class="label-text">Start Time</span>
                    </label>
                    <input type="time" name="start_time" class="input input-bordered" required>
                </div>
                
                <div class="form-control">
                    <label class="label">
                        <span class="label-text">End Time</span>
                    </label>
                    <input type="time" name="end_time" class="input input-bordered" required>
                </div>
            </div>
            
            <div class="form-control mb-3">
                <label class="label">
                    <span class="label-text">Description (optional)</span>
                </label>
                <textarea name="description" class="textarea textarea-bordered" rows="2" 
                          placeholder="Additional details about this special session"></textarea>
            </div>
            
            <div class="modal-action">
                <button type="button" class="btn" onclick="specialSessionModal.close()">Cancel</button>
                <button type="submit" class="btn btn-primary">Add Session</button>
            </div>
        </form>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

<!-- Add Holiday Modal -->
<dialog id="holidayModal" class="modal">
    <div class="modal-box">
        <h3 class="font-bold text-lg mb-4">Add Market Holiday</h3>
        <form method="POST" action="{{ url_for('trading.add_holiday') }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            
            <div class="form-control mb-3">
                <label class="label">
                    <span class="label-text">Holiday Date</span>
                </label>
                <input type="date" name="holiday_date" class="input input-bordered" required>
            </div>
            
            <div class="form-control mb-3">
                <label class="label">
                    <span class="label-text">Holiday Name</span>
                </label>
                <input type="text" name="holiday_name" class="input input-bordered" placeholder="e.g., Diwali" required>
            </div>
            
            <div class="form-control mb-3">
                <label class="label">
                    <span class="label-text">Market</span>
                </label>
                <select name="market" class="select select-bordered">
                    <option value="NSE" selected>NSE</option>
                    <option value="BSE">BSE</option>
                    <option value="MCX">MCX</option>
                </select>
            </div>
            
            <div class="form-control mb-3">
                <label class="label cursor-pointer">
                    <span class="label-text">Special Session</span>
                    <input type="checkbox" name="is_special_session" class="checkbox" onchange="toggleSpecialSession(this)">
                </label>
            </div>
            
            <div id="specialSessionTimes" class="hidden">
                <div class="form-control mb-3">
                    <label class="label">
                        <span class="label-text">Special Start Time</span>
                    </label>
                    <input type="time" name="special_start_time" class="input input-bordered">
                </div>
                
                <div class="form-control mb-3">
                    <label class="label">
                        <span class="label-text">Special End Time</span>
                    </label>
                    <input type="time" name="special_end_time" class="input input-bordered">
                </div>
            </div>
            
            <div class="modal-action">
                <button type="button" class="btn" onclick="holidayModal.close()">Cancel</button>
                <button type="submit" class="btn btn-primary">Add Holiday</button>
            </div>
        </form>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

<!-- Delete Holiday Form (hidden) -->
<form id="deleteHolidayForm" method="POST" style="display: none;">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
</form>

<!-- Delete Special Session Form (hidden) -->
<form id="deleteSpecialSessionForm" method="POST" style="display: none;">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
</form>

<script>
function addNewTemplate() {
    alert('To add a new template, please contact the administrator or use the API');
}

function editTemplate(templateId) {
    // For now, toggle active status
    fetch(`{{ url_for('trading.toggle_template', template_id=0) }}`.replace('0', templateId), {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token() }}'
        }
    }).then(response => {
        if (response.ok) {
            window.location.reload();
        }
    });
}

function deleteTemplate(templateId) {
    if (confirm('Are you sure you want to delete this template?')) {
        alert('Template deletion is restricted to prevent system issues');
    }
}

function editSessions(templateId, templateName) {
    document.getElementById('edit-template-id').value = templateId;
    
    // Load current session data if needed
    fetch(`{{ url_for('trading.get_sessions', template_id=0) }}`.replace('0', templateId))
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // Populate form with existing session times
                data.sessions.forEach(session => {
                    const day = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'][session.day_of_week];
                    const startInput = document.querySelector(`input[name="${day}_start"]`);
                    const endInput = document.querySelector(`input[name="${day}_end"]`);
                    const activeInput = document.querySelector(`input[name="${day}_active"]`);
                    
                    if (startInput) startInput.value = session.start_time;
                    if (endInput) endInput.value = session.end_time;
                    if (activeInput) activeInput.checked = session.is_active;
                });
            }
        });
    
    document.getElementById('editSessionModal').showModal();
}

function quickEditSession(sessionId) {
    // Get current values from the row
    const row = document.getElementById(`session-${sessionId}`);
    const startTime = row.querySelector('.start-time').textContent;
    const endTime = row.querySelector('.end-time').textContent;
    
    document.getElementById('quick-session-id').value = sessionId;
    document.getElementById('quick-start-time').value = startTime;
    document.getElementById('quick-end-time').value = endTime;
    
    document.getElementById('quickEditModal').showModal();
}

function saveQuickEdit() {
    const sessionId = document.getElementById('quick-session-id').value;
    const startTime = document.getElementById('quick-start-time').value;
    const endTime = document.getElementById('quick-end-time').value;
    
    fetch(`{{ url_for('trading.update_session', session_id=0) }}`.replace('0', sessionId), {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token() }}'
        },
        body: JSON.stringify({
            start_time: startTime,
            end_time: endTime
        })
    }).then(response => {
        if (response.ok) {
            // Update the UI immediately
            const row = document.getElementById(`session-${sessionId}`);
            row.querySelector('.start-time').textContent = startTime;
            row.querySelector('.end-time').textContent = endTime;
            
            quickEditModal.close();
            
            // Show success message
            showNotification('Session updated successfully', 'success');
        } else {
            showNotification('Failed to update session', 'error');
        }
    });
}

function addSpecialSession() {
    document.getElementById('specialSessionModal').showModal();
}

function deleteSpecialSession(sessionId, sessionName) {
    if (confirm(`Are you sure you want to delete the special session "${sessionName}"?`)) {
        const form = document.getElementById('deleteSpecialSessionForm');
        form.action = `{{ url_for('trading.delete_special_session', session_id=0) }}`.replace('0', sessionId);
        form.submit();
    }
}

function addHoliday() {
    document.getElementById('holidayModal').showModal();
}

function deleteHoliday(holidayId, holidayName) {
    if (confirm(`Are you sure you want to delete the holiday "${holidayName}"?`)) {
        const form = document.getElementById('deleteHolidayForm');
        form.action = `{{ url_for('trading.delete_holiday', holiday_id=0) }}`.replace('0', holidayId);
        form.submit();
    }
}

function toggleSpecialSession(checkbox) {
    const specialSessionDiv = document.getElementById('specialSessionTimes');
    if (checkbox.checked) {
        specialSessionDiv.classList.remove('hidden');
    } else {
        specialSessionDiv.classList.add('hidden');
    }
}

function showNotification(message, type) {
    // Create a temporary notification
    const notification = document.createElement('div');
    notification.className = `alert alert-${type === 'success' ? 'success' : 'error'} fixed top-4 right-4 z-50 max-w-sm`;
    notification.innerHTML = `
        <span>${message}</span>
    `;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}
</script>
{% endblock %}